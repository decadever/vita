<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        body{
            text-align: center;
            background: #000000;
        }
        #c1{
            background: #000000;
        }
    </style>
    <script>
        window.onload = function(){
            var oC = document.getElementById("c1");
            var gd = oC.getContext("2d");

            var winW = window.innerWidth;
            var winH = window.innerHeight;
            oC.width = winW;
            oC.height = winH;

            var N = 5;

            var x = 100;
            var y = 100;
            var w = 4;
            var h = 4;
            var speedX = 10;
            var speedY = 10;
            var aPoint = [];
            var oldPoint = [];

            //创建原始点
            for (var i = 0; i < N; i++){
                aPoint.push({
                    x:rnd(0,winW),
                    y:rnd(0,winH),
                    w:w,
                    h:h,
                    speedX:rnd(-speedX,speedX),
                    speedY:rnd(-speedY,speedY)
                });
            }

            var timer = setInterval(function(){

                //清除历史位置
                gd.clearRect(0,0,oC.width,oC.height);
                for (var i = 0; i < N; i++){
                    drawPoint(aPoint[i]);

                    aPoint[i].x += aPoint[i].speedX;
                    aPoint[i].y += aPoint[i].speedY;

                    //限定范围
                    if (aPoint[i].x < 0){
                        aPoint[i].speedX *= -1;
                    }else if(aPoint[i].x >= winW){
                        aPoint[i].speedX *= -1;
                    }

                    if (aPoint[i].y < 0){
                        aPoint[i].speedY *= -1;
                    }else if(aPoint[i].y >= winH){
                        aPoint[i].speedY *= -1;
                    }
                }

                //连线
                gd.beginPath();
                gd.moveTo(aPoint[0].x,aPoint[0].y);
                for (var i = 0; i < N; i++){
                    gd.lineTo(aPoint[i].x,aPoint[i].y);
                }
                gd.closePath();
                gd.strokeStyle = "blue";
                gd.stroke();

                //存上一个平面
                var tmp = [];
                for (var i = 0; i < N; i++){
                    tmp.push({x:aPoint[i].x,y:aPoint[i].y});
                }
                oldPoint.push(tmp);
                //删除
                while (oldPoint.length > 15){
                    oldPoint.shift();
                }
                //绘制平面

                for (var i = 0; i < oldPoint.length; i++){
                    gd.beginPath();

                    gd.moveTo(oldPoint[i][0].x,oldPoint[i][0].y);
                    for (var j = 1; j < N; j++){
                        gd.lineTo(oldPoint[i][j].x,oldPoint[i][j].y);
                    }
                    gd.closePath();
                    var opacity = i/oldPoint.length;
                    gd.strokeStyle = "rgba(0,0,255,"+ opacity +")";
                    gd.stroke();
                }

            },30);

            //画点函数
            function drawPoint (p){
                gd.fillStyle = "#fff";
                gd.fillRect(p.x,p.y, p.w, p.h);
                gd.strokeRect(p.x,p.y, p.w, p.h);
            }

            //随机数函数
            function rnd(n,m){
                return Math.floor(Math.random()*(m-n)+1);
            }
        }
    </script>
</head>
<body>
<canvas id="c1"></canvas>
</body>
</html>